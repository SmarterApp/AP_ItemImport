package org.opentestsystem.ap.itemimport.model;

import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@NoArgsConstructor
public class StandardIdProps {
    String claim;

    String domain;

    String target;

    String grade;

    String emphasis;

    String commonCoreStandard;

    String testCategory;

    String targetSet;

    /**
     *
     * @param value
     */
    public StandardIdProps loadFromValue(String idType, String value) {
        StandardIdProps props = new StandardIdProps();

        String[] valueArray = value.split("|");
        if (valueArray.length > 0) {
            String[] firstValue = valueArray[0].split(":");
            if (IatImportConstants.STANDARD_PUB_FORMAT_MATH_V4.equals(idType)
                    || IatImportConstants.STANDARD_PUB_FORMAT_MATH_V5.equals(idType)) {
                // SBAC-MA-v4:1|NBT|E-3|a/s|3.NBT.2
                // SBAC-MA-v5:1|NS|B-7|m|7.NS.A
                if (valueArray.length == 5) {
                    if (firstValue.length == 2) {
                        props.setClaim(firstValue[1]);
                    }
                    props.setDomain(valueArray[1]);
                    String[] thirdValue = valueArray[2].split("-");
                    if (thirdValue.length == 2) {
                        props.setTarget(thirdValue[0]);
                        props.setGrade(thirdValue[1]);
                    }
                    props.setEmphasis(valueArray[3]);
                    props.setCommonCoreStandard(valueArray[4]);
                }
            } else if (IatImportConstants.STANDARD_PUB_FORMAT_MATH_V6.equals(idType)) {
                // SBAC-MA-v6:1|S|TS04|E-3
                if (valueArray.length == 4) {
                    if (firstValue.length == 2) {
                        props.setClaim(firstValue[1]);
                    }
                    props.setTestCategory(valueArray[1]);
                    props.setTargetSet(valueArray[2]);
                    String[] fourthValue = valueArray[2].split("-");
                    if (fourthValue.length == 2) {
                        props.setTarget(fourthValue[0]);
                        props.setGrade(fourthValue[1]);
                    }
                }
            } else if (IatImportConstants.STANDARD_PUB_FORMAT_ELA_V1.equals(idType)) {
                // SBAC-ELA-v1:1-IT|9-11|11-12.RI.2
                if (valueArray.length == 3) {
                    if (firstValue.length == 3) {
                        String[] claimContent = firstValue[1].split("-");
                        if (claimContent.length == 2) {
                            props.setClaim(claimContent[0]);
                            props.setDomain(claimContent[1]);
                        }
                        String[] targetGrade = valueArray[1].split("-");
                        if (targetGrade.length == 2) {
                            props.setTarget(targetGrade[0]);
                            props.setGrade(targetGrade[1]);
                        }
                        props.setCommonCoreStandard(valueArray[2]);
                    }
                }
            }
        }

        return props;
    }

}
